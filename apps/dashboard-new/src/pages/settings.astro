---
import LayoutSidebar from '../app/LayoutSidebar.astro';
---

<LayoutSidebar>
	<div class="space-y-6">
		<div>
			<h1 class="text-2xl font-bold text-white">Settings</h1>
			<p class="text-gray-400">Configure your ClawFi instance</p>
		</div>

		<!-- General Settings -->
		<div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
			<div class="px-6 py-4 border-b border-gray-700">
				<h2 class="text-lg font-semibold text-white">General</h2>
			</div>
			<div class="p-6 space-y-4">
				<div>
					<label class="block text-sm font-medium text-gray-300 mb-2">API URL</label>
					<input
						type="text"
						id="api-url"
						class="w-full px-4 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-300"
						readonly
					/>
				</div>
				<div>
					<label class="block text-sm font-medium text-gray-300 mb-2">Version</label>
					<input
						type="text"
						value="0.1.0"
						class="w-full px-4 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-gray-300"
						readonly
					/>
				</div>
			</div>
		</div>

		<!-- Notifications -->
		<div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
			<div class="px-6 py-4 border-b border-gray-700">
				<h2 class="text-lg font-semibold text-white">Notifications</h2>
			</div>
			<div class="p-6 space-y-4">
				<div class="flex items-center justify-between">
					<div>
						<p class="font-medium text-white">Browser Notifications</p>
						<p class="text-sm text-gray-400">Get notified of new signals</p>
					</div>
					<button id="enable-notifications" class="px-4 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors">
						Enable
					</button>
				</div>
				<div class="flex items-center justify-between">
					<div>
						<p class="font-medium text-white">Telegram Bot</p>
						<p class="text-sm text-gray-400">Receive signals via Telegram</p>
					</div>
					<span class="px-3 py-1 text-sm bg-gray-700 text-gray-400 rounded-lg">
						Configure in .env
					</span>
				</div>
			</div>
		</div>

		<!-- Danger Zone -->
		<div class="bg-gray-800 rounded-xl border border-red-700/50 overflow-hidden">
			<div class="px-6 py-4 border-b border-red-700/50 bg-red-900/20">
				<h2 class="text-lg font-semibold text-red-400">Danger Zone</h2>
			</div>
			<div class="p-6 space-y-4">
				<div class="flex items-center justify-between">
					<div>
						<p class="font-medium text-white">Clear All Data</p>
						<p class="text-sm text-gray-400">Remove all signals, connections, and configurations</p>
					</div>
					<button class="px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
						Clear Data
					</button>
				</div>
				<div class="flex items-center justify-between">
					<div>
						<p class="font-medium text-white">Sign Out</p>
						<p class="text-sm text-gray-400">End your current session</p>
					</div>
					<button id="logout-btn" class="px-4 py-2 text-sm bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
						Sign Out
					</button>
				</div>
			</div>
		</div>
	</div>
</LayoutSidebar>

<script>
	const token = localStorage.getItem('clawfi_token');
	if (!token) window.location.href = '/login';
	
	const API_URL = import.meta.env.PUBLIC_API_URL || 'http://localhost:3001';
	document.getElementById('api-url')?.setAttribute('value', API_URL);
	
	document.getElementById('logout-btn')?.addEventListener('click', () => {
		localStorage.removeItem('clawfi_token');
		window.location.href = '/login';
	});
	
	document.getElementById('enable-notifications')?.addEventListener('click', async () => {
		if ('Notification' in window) {
			const permission = await Notification.requestPermission();
			if (permission === 'granted') {
				new Notification('ClawFi', { body: 'Notifications enabled!' });
			}
		}
	});
</script>
